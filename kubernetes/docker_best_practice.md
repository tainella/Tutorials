# Docker Best practice

## Скорость и размер

Использовать как можно меньше инструкций RUN. Обходиться одной с помощью "&& \". Особенно при установке пакетов.

После apt-get в конце через "&&" добавлять очищение кеша: "rm -rf /var/lib/apt/lists/*".

## .dockerignore

Способ убрать из образа папки, оформляется как .gitignore

## ENV

Переменные ENV для версий для наглядности сверху докерфайла.

## Корректный запуск

ENTRYPOINT ["app"]

CMD ["--help"]

флаги в CMD

# Усиливаем контроль и безопасность

- Не используем latest тег
- Указываем явные версии ПО
- Один процесс один контейнер
- Метрики и логи приложения
- Настройка приложения через env
- Resource management (ограничения по памяти)
- Минимум привилегий процесса (mount, host network)
- Свой базовый образ

# Docker-compose

Позволяет запускать проект из нескольких контейнеров. 

Оптимальна 2 версия.

healthcheck - проверка запущен ли контейнер. (Тестовые запросы с некоторой периодчностью и timeout)

enviroment - блок для передачи переменных окружения.

# CI/CD

## GitLab, Jenkins, Bitbucket

Код подается на прод как конвейер. Есть инструкция.

CI: Build, Test

CD: Review, Staging (промежуточный сервер для тестирования), Production






